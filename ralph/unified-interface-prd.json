{
  "metadata": {
    "title": "Unified Interface PRD - The Red Council",
    "version": "1.1.0",
    "created": "2026-02-02",
    "updated": "2026-02-02",
    "phase": "8",
    "description": "Product Requirements Document for consolidating Streamlit and Next.js interfaces into a unified modern frontend",
    "total_epics": 6,
    "total_stories": 37,
    "estimated_weeks": 5,
    "review_status": "Reviewed and updated based on independent code review",
    "tracking_enabled": true,
    "branchName": "feature/agent-security-v0.5.0",
    "project": "The Red Council - Unified Interface"
  },
  "epics": [
    {
      "id": "E1",
      "title": "Foundation & Navigation",
      "description": "Establish unified navigation and routing structure for the combined interface",
      "priority": 1,
      "estimated_points": 10,
      "stories": [
        {
          "id": "UI-001",
          "title": "App-wide Layout with Sidebar Navigation",
          "description": "Create the main application shell with collapsible sidebar navigation supporting both LLM and Agent testing modes",
          "points": 3,
          "priority": 1,
          "acceptance_criteria": [
            "Sidebar displays navigation links: Dashboard, LLM Testing, Agent Testing, Reports, Settings",
            "Sidebar can collapse to icon-only mode on desktop",
            "Active route is visually highlighted",
            "Agent Testing section expands to show sub-routes (Connect, Monitor, Attack, Results)",
            "Navigation state persists across page refreshes",
            "Responsive: sidebar becomes bottom nav or hamburger menu on mobile"
          ],
          "technical_notes": "Use shadcn/ui Sheet component for mobile, custom sidebar for desktop. Store collapsed state in localStorage.",
          "files_to_create": [
            "frontend/components/layout/Sidebar.tsx",
            "frontend/components/layout/AppShell.tsx",
            "frontend/components/layout/MobileNav.tsx"
          ],
          "depends_on": [],
          "passes": true,
          "phaseId": 1
        },
        {
          "id": "UI-002",
          "title": "Mode Selector Component",
          "description": "Create a prominent mode selector allowing users to switch between LLM Testing, Agent Testing, and Demo Mode",
          "points": 2,
          "priority": 1,
          "acceptance_criteria": [
            "Three mode options: LLM Testing, Agent Testing, Demo Mode",
            "Visual indicator shows current mode",
            "Mode switch updates global state and navigates to appropriate route",
            "Demo Mode shows special badge/indicator throughout UI",
            "Confirmation dialog when switching modes with unsaved data"
          ],
          "technical_notes": "Use Zustand store for mode state. Mode selector appears on dashboard and in header.",
          "files_to_create": [
            "frontend/components/ModeSelector.tsx",
            "frontend/stores/testingMode.ts"
          ],
          "depends_on": [],
          "passes": true,
          "phaseId": 1
        },
        {
          "id": "UI-003",
          "title": "Dashboard Home Page",
          "description": "Create unified dashboard showing quick stats and entry points for all testing modes",
          "points": 2,
          "priority": 1,
          "acceptance_criteria": [
            "Stats cards showing: Active Sessions, Campaigns Run, Reports Generated, Vulnerabilities Found",
            "Quick action buttons for each testing mode",
            "Recent activity feed showing last 5 actions",
            "System status indicator (API health, connection status)"
          ],
          "technical_notes": "Use React Query to fetch stats from API. Implement skeleton loading states.",
          "files_to_create": [
            "frontend/app/dashboard/page.tsx",
            "frontend/components/dashboard/StatsCards.tsx",
            "frontend/components/dashboard/RecentActivity.tsx"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": true,
          "phaseId": 1
        },
        {
          "id": "UI-004",
          "title": "Settings Page Skeleton",
          "description": "Create settings page structure with tabs for different configuration sections",
          "points": 2,
          "priority": 2,
          "acceptance_criteria": [
            "Tab navigation: General, Agent Config, API Keys, Appearance",
            "Each tab shows placeholder content",
            "Settings persist to localStorage initially",
            "Dark/Light mode toggle functional"
          ],
          "technical_notes": "Use shadcn/ui Tabs component. Settings stored in Zustand with localStorage persistence.",
          "files_to_create": [
            "frontend/app/settings/page.tsx",
            "frontend/stores/settings.ts"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": true,
          "phaseId": 1
        },
        {
          "id": "UI-005",
          "title": "Responsive Mobile Navigation",
          "description": "Ensure navigation works seamlessly on mobile devices",
          "points": 1,
          "priority": 2,
          "acceptance_criteria": [
            "Bottom navigation bar on mobile with key routes",
            "Hamburger menu for full navigation access",
            "Touch-friendly tap targets (min 44px)",
            "Swipe gestures for navigation where appropriate"
          ],
          "technical_notes": "Use CSS media queries and useMediaQuery hook. Test on various screen sizes.",
          "files_to_create": [
            "frontend/components/layout/BottomNav.tsx",
            "frontend/hooks/useMediaQuery.ts"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": true,
          "phaseId": 1
        }
      ]
    },
    {
      "id": "E2",
      "title": "Demo Mode Experience",
      "description": "Enable first-time users to explore the platform without setup using pre-loaded sample data",
      "priority": 1,
      "estimated_points": 12,
      "stories": [
        {
          "id": "UI-006",
          "title": "Welcome Modal with Mode Selection",
          "description": "Create onboarding modal for first-time users to choose their starting path",
          "points": 3,
          "priority": 1,
          "acceptance_criteria": [
            "Modal appears on first visit (tracked in localStorage)",
            "Three paths presented: 'Try Demo', 'Connect My Agent', 'Test an LLM'",
            "Each path has brief description and icon",
            "Skip option available",
            "Selecting a path navigates to appropriate screen"
          ],
          "technical_notes": "Use shadcn/ui Dialog. Store 'hasSeenWelcome' in localStorage.",
          "files_to_create": [
            "frontend/components/onboarding/WelcomeModal.tsx",
            "frontend/stores/onboarding.ts"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": true,
          "phaseId": 2
        },
        {
          "id": "UI-007",
          "title": "Demo Data Loading Service",
          "description": "Create service to load pre-configured sample data for demo mode",
          "points": 2,
          "priority": 1,
          "acceptance_criteria": [
            "Load 22 sample agent events (matching current VulnerableTestAgent output)",
            "Include tool calls, memory access, speech, and divergence events",
            "Demo data includes pre-computed evaluation scores",
            "Loading state shown during data fetch",
            "Demo badge appears in UI when demo mode active"
          ],
          "technical_notes": "Store demo data in static JSON files. Use React Query for loading with caching.",
          "files_to_create": [
            "frontend/lib/demo/demoData.ts",
            "frontend/lib/demo/loadDemoSession.ts",
            "frontend/data/demo-events.json"
          ],
          "depends_on": [
            "UI-002"
          ],
          "passes": true,
          "phaseId": 2
        },
        {
          "id": "UI-008",
          "title": "Quick Start Guide Components",
          "description": "Build contextual guide components that appear during onboarding",
          "points": 3,
          "priority": 1,
          "acceptance_criteria": [
            "Step-by-step guide for each testing mode",
            "Numbered steps with descriptions",
            "Checkboxes to mark steps complete",
            "Guide can be minimized but remains accessible",
            "Progress saves to localStorage"
          ],
          "technical_notes": "Create reusable QuickStartGuide component. Each mode has different steps.",
          "files_to_create": [
            "frontend/components/onboarding/QuickStartGuide.tsx",
            "frontend/components/onboarding/GuideStep.tsx",
            "frontend/data/guide-steps.ts"
          ],
          "depends_on": [
            "UI-006"
          ],
          "passes": true,
          "phaseId": 2
        },
        {
          "id": "UI-009",
          "title": "Onboarding Progress Indicator",
          "description": "Show user's progress through onboarding in sidebar",
          "points": 2,
          "priority": 1,
          "acceptance_criteria": [
            "Progress bar shows completion percentage",
            "Expandable to show individual step status",
            "Clicking a step navigates to relevant screen",
            "Option to dismiss permanently",
            "Appears only for new users"
          ],
          "technical_notes": "Integrate with onboarding store. Show in sidebar below navigation.",
          "files_to_create": [
            "frontend/components/onboarding/ProgressIndicator.tsx"
          ],
          "depends_on": [
            "UI-008"
          ],
          "passes": true,
          "phaseId": 2
        },
        {
          "id": "UI-010",
          "title": "Empty States Design",
          "description": "Design and implement empty states for all major screens",
          "points": 2,
          "priority": 1,
          "acceptance_criteria": [
            "Empty state for: Timeline (no events), Reports (no reports), Sessions (no sessions)",
            "Each includes illustration/icon, message, and call-to-action button",
            "Demo mode empty states suggest loading demo data",
            "Consistent visual style across all empty states"
          ],
          "technical_notes": "Create EmptyState component with variants. Use Lucide icons.",
          "files_to_create": [
            "frontend/components/EmptyState.tsx"
          ],
          "depends_on": [],
          "passes": true,
          "phaseId": 2
        }
      ]
    },
    {
      "id": "E3",
      "title": "Agent Testing Features",
      "description": "Port all agent testing capabilities from Streamlit to Next.js",
      "priority": 1,
      "estimated_points": 29,
      "stories": [
        {
          "id": "UI-011",
          "title": "SDK Integration Panel",
          "description": "Build panel showing code snippets for integrating with LangChain, LangGraph, and MCP",
          "points": 5,
          "priority": 1,
          "acceptance_criteria": [
            "Tab selector for framework: LangChain, LangGraph, MCP, Custom",
            "Syntax-highlighted code snippet for selected framework",
            "Copy-to-clipboard button with success feedback",
            "Dynamic session ID and webhook URL injection into snippets",
            "Expandable sections for: Installation, Initialization, Usage Example"
          ],
          "technical_notes": "Use Prism.js or Shiki for syntax highlighting. Snippets stored in data files.",
          "files_to_create": [
            "frontend/app/agent/connect/page.tsx",
            "frontend/components/agent/SDKPanel.tsx",
            "frontend/components/CodeSnippet.tsx",
            "frontend/data/sdk-snippets.ts"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": true,
          "phaseId": 3
        },
        {
          "id": "UI-012",
          "title": "Remote Agent Configuration Form",
          "description": "Create form for configuring HTTP endpoint testing of remote agents",
          "points": 5,
          "priority": 1,
          "acceptance_criteria": [
            "Endpoint URL input with validation",
            "Timeout configuration (5-120 seconds slider)",
            "Authentication options: None, Bearer Token, API Key Header",
            "Request format: OpenAI-compatible or Custom JSON template",
            "Response extraction: Auto-detect or JSON path",
            "Test Connection button with result display",
            "Save configuration to session state"
          ],
          "technical_notes": "Use react-hook-form for form state. Validate URL format. Store in Zustand.",
          "files_to_create": [
            "frontend/components/agent/RemoteAgentForm.tsx",
            "frontend/lib/api/testConnection.ts",
            "frontend/stores/remoteAgent.ts"
          ],
          "depends_on": [
            "UI-011"
          ],
          "passes": true,
          "phaseId": 3
        },
        {
          "id": "UI-013",
          "title": "Connection Testing",
          "description": "Implement connection testing for remote agent endpoints",
          "points": 3,
          "priority": 1,
          "acceptance_criteria": [
            "Test button sends sample request to configured endpoint",
            "Loading state during test",
            "Success: Show response preview and latency",
            "Failure: Show error message with troubleshooting hints",
            "Connection status indicator persists in UI"
          ],
          "technical_notes": "API route proxies request to avoid CORS. Timeout handling important.",
          "files_to_create": [
            "frontend/components/agent/ConnectionTester.tsx",
            "frontend/app/api/test-connection/route.ts"
          ],
          "depends_on": [
            "UI-012"
          ],
          "passes": true,
          "phaseId": 3
        },
        {
          "id": "UI-014",
          "title": "Real-time Event Stream Viewer",
          "description": "Build live event stream showing incoming agent events",
          "points": 5,
          "priority": 1,
          "acceptance_criteria": [
            "Real-time event list with newest at top",
            "Event type badges: Tool Call, Memory, Speech, Action, Divergence",
            "Auto-scroll with pause on user scroll",
            "Event count indicator",
            "Clear stream button",
            "Filter by event type",
            "Export events as JSON with proper schema (events array with metadata)",
            "Maximum event count limit (5000 events) with warning when reached",
            "Export file size limit (10MB) with warning when exceeded"
          ],
          "technical_notes": "Poll /api/v1/agent/session/{id}/events endpoint. Use useInterval hook. Virtualize long lists. Match MAX_EVENTS_LIMIT and MAX_EXPORT_SIZE_BYTES from Streamlit.",
          "files_to_create": [
            "frontend/app/agent/monitor/page.tsx",
            "frontend/components/agent/EventStream.tsx",
            "frontend/hooks/useEventStream.ts"
          ],
          "depends_on": [
            "UI-001",
            "UI-011"
          ],
          "passes": true,
          "phaseId": 3
        },
        {
          "id": "UI-015",
          "title": "Agent Timeline Visualization",
          "description": "Create chronological timeline view of agent events",
          "points": 5,
          "priority": 1,
          "acceptance_criteria": [
            "Vertical timeline with expandable event cards",
            "Timestamp and relative time display",
            "Event type icons and color coding",
            "Filter chips for event types",
            "Pagination with 20 events per page",
            "Click to expand shows full event details",
            "Download JSON export button"
          ],
          "technical_notes": "Port from agent_timeline.py. Use virtualized list for performance.",
          "files_to_create": [
            "frontend/components/agent/Timeline.tsx",
            "frontend/components/agent/TimelineEvent.tsx"
          ],
          "depends_on": [
            "UI-014"
          ],
          "passes": true,
          "phaseId": 3
        },
        {
          "id": "UI-016",
          "title": "Tool Chain Visualization",
          "description": "Build visualization showing tool call patterns and chains",
          "points": 3,
          "priority": 2,
          "acceptance_criteria": [
            "Summary stats: Total calls, Unique tools, Error rate, ASI01 violations",
            "Loop detection warnings highlighted (threshold: 3 consecutive identical calls)",
            "Excessive calls warning (threshold: 10 total calls to same tool)",
            "Tool usage frequency chart",
            "Sequential call chain diagram",
            "Expandable tool call details",
            "Fallback rendering: React-based graph -> SVG diagram -> text list",
            "Configurable thresholds via settings (LOOP_THRESHOLD=3, EXCESSIVE_CALLS_THRESHOLD=10)"
          ],
          "technical_notes": "Port from tool_chain.py. Use Recharts for visualizations. Implement graceful degradation for graph rendering.",
          "files_to_create": [
            "frontend/components/agent/ToolChain.tsx",
            "frontend/components/agent/ToolStats.tsx"
          ],
          "depends_on": [
            "UI-014"
          ],
          "passes": true,
          "phaseId": 3
        },
        {
          "id": "UI-017",
          "title": "Agent Configuration Panel",
          "description": "Create configuration panel for agent instrumentation settings",
          "points": 3,
          "priority": 2,
          "acceptance_criteria": [
            "Toggle: Enable Tool Interception",
            "Toggle: Enable Memory Monitoring",
            "Divergence Threshold slider (0.0 - 1.0)",
            "Event Sampling Rate slider",
            "Tool Registration form (name, description, dangerous flag)",
            "Memory Policy configuration",
            "Settings sync with session state"
          ],
          "technical_notes": "Store in Zustand. Sync with API session configuration.",
          "files_to_create": [
            "frontend/components/agent/ConfigPanel.tsx",
            "frontend/components/agent/ToolRegistration.tsx"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": true,
          "phaseId": 3
        }
      ]
    },
    {
      "id": "E4",
      "title": "Attack Campaign Features",
      "description": "Enable attack template selection and campaign execution against agents",
      "priority": 1,
      "estimated_points": 18,
      "stories": [
        {
          "id": "UI-018",
          "title": "Attack Template Selector",
          "description": "Build searchable, filterable attack template library UI",
          "points": 5,
          "priority": 1,
          "acceptance_criteria": [
            "Grid/list view toggle",
            "Search by template name or content",
            "Filter by OWASP category (ASI01-ASI10)",
            "Filter by source (HarmBench, PyRIT, garak, Custom)",
            "Multi-select templates for campaign",
            "Template count badges on filters",
            "Preview template on hover/click"
          ],
          "technical_notes": "Fetch templates from /api/v1/templates. Implement client-side filtering for responsiveness.",
          "files_to_create": [
            "frontend/app/agent/attack/page.tsx",
            "frontend/components/attack/TemplateSelector.tsx",
            "frontend/components/attack/TemplateCard.tsx",
            "frontend/components/attack/TemplateFilters.tsx"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": false,
          "phaseId": 4
        },
        {
          "id": "UI-019",
          "title": "OWASP Category Filter UI",
          "description": "Create visual OWASP category filter with descriptions",
          "points": 3,
          "priority": 1,
          "acceptance_criteria": [
            "10 category badges (ASI01-ASI10)",
            "Hover shows full category name and description",
            "Click to toggle filter",
            "Selected categories highlighted",
            "Clear all / Select all buttons",
            "Template count per category shown"
          ],
          "technical_notes": "OWASP category data in constants file. Use Tooltip component.",
          "files_to_create": [
            "frontend/components/attack/OWASPFilter.tsx",
            "frontend/data/owasp-categories.ts"
          ],
          "depends_on": [
            "UI-018"
          ],
          "passes": false,
          "phaseId": 4
        },
        {
          "id": "UI-020",
          "title": "Campaign Runner with Controls",
          "description": "Build campaign execution interface with start/pause/stop controls",
          "points": 5,
          "priority": 1,
          "acceptance_criteria": [
            "Selected templates summary panel",
            "Start Campaign button (disabled if no templates selected)",
            "Pause/Resume and Stop buttons during execution",
            "Progress bar showing completion percentage",
            "Current template indicator",
            "Live results summary updating as campaign runs",
            "Campaign duration timer",
            "Campaign pause/resume state persists across page refreshes",
            "Error handling for failed template loading with retry option"
          ],
          "technical_notes": "Use SSE or polling for campaign progress. Disable navigation during active campaign. Persist campaign state to localStorage.",
          "files_to_create": [
            "frontend/components/attack/CampaignRunner.tsx",
            "frontend/components/attack/CampaignControls.tsx",
            "frontend/hooks/useCampaign.ts"
          ],
          "depends_on": [
            "UI-018",
            "UI-012"
          ],
          "passes": false,
          "phaseId": 4
        },
        {
          "id": "UI-021",
          "title": "Campaign Progress Visualization",
          "description": "Show real-time campaign progress with per-template status",
          "points": 3,
          "priority": 2,
          "acceptance_criteria": [
            "Template list showing: Pending, Running, Complete, Failed status",
            "Current template highlighted",
            "Expandable to show template-specific results",
            "Overall success/failure rate indicator",
            "Estimated time remaining"
          ],
          "technical_notes": "Poll campaign status endpoint. Update state incrementally.",
          "files_to_create": [
            "frontend/components/attack/CampaignProgress.tsx"
          ],
          "depends_on": [
            "UI-020"
          ],
          "passes": false,
          "phaseId": 4
        },
        {
          "id": "UI-022",
          "title": "Template Preview Component",
          "description": "Create modal/panel for previewing template details",
          "points": 2,
          "priority": 2,
          "acceptance_criteria": [
            "Template name and ID",
            "Full prompt content with syntax highlighting",
            "OWASP category badge",
            "Source attribution",
            "Expected behavior description",
            "Add to selection button"
          ],
          "technical_notes": "Use shadcn/ui Sheet component for slide-out preview.",
          "files_to_create": [
            "frontend/components/attack/TemplatePreview.tsx"
          ],
          "depends_on": [
            "UI-018"
          ],
          "passes": false,
          "phaseId": 4
        }
      ]
    },
    {
      "id": "E5",
      "title": "Reporting & Analytics",
      "description": "Comprehensive security reporting with export capabilities",
      "priority": 2,
      "estimated_points": 24,
      "stories": [
        {
          "id": "UI-023",
          "title": "OWASP Coverage Grid",
          "description": "Build visual grid showing ASI01-ASI10 vulnerability coverage",
          "points": 5,
          "priority": 1,
          "acceptance_criteria": [
            "10x1 or 5x2 grid of OWASP categories",
            "Color coding: Red (detected, severity >= 4), Yellow (warning, severity < 4), Green (passed), Gray (not tested)",
            "WARNING_SEVERITY_THRESHOLD configurable (default: 4)",
            "Click category for detailed findings",
            "Severity score per category",
            "Overall coverage percentage",
            "Expandable details panel",
            "Handle orphan violations with invalid/unknown categories gracefully"
          ],
          "technical_notes": "Port from owasp_coverage.py. Use CSS Grid or flexbox. Match Streamlit WARNING_SEVERITY_THRESHOLD=4.",
          "files_to_create": [
            "frontend/app/agent/results/page.tsx",
            "frontend/components/reports/OWASPGrid.tsx",
            "frontend/components/reports/CategoryCard.tsx"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": false,
          "phaseId": 5
        },
        {
          "id": "UI-024",
          "title": "Section-based Report Viewer",
          "description": "Create comprehensive report viewer with collapsible sections",
          "points": 5,
          "priority": 1,
          "acceptance_criteria": [
            "Sections: Executive Summary, Risk Score, OWASP Findings, Recommendations, Event Analysis",
            "Collapsible/expandable sections",
            "Navigation sidebar for quick section jumping",
            "Print-friendly layout option",
            "Risk score visualization (gauge or badge)"
          ],
          "technical_notes": "Port from report_viewer.py. Use Intersection Observer for section tracking.",
          "files_to_create": [
            "frontend/app/reports/[id]/page.tsx",
            "frontend/components/reports/ReportViewer.tsx",
            "frontend/components/reports/ReportSection.tsx",
            "frontend/components/reports/RiskGauge.tsx"
          ],
          "depends_on": [
            "UI-023"
          ],
          "passes": false,
          "phaseId": 5
        },
        {
          "id": "UI-025",
          "title": "Markdown Export",
          "description": "Implement markdown export for reports",
          "points": 2,
          "priority": 1,
          "acceptance_criteria": [
            "Export button triggers download",
            "Filename includes timestamp and session ID",
            "Markdown includes all report sections",
            "Tables formatted correctly",
            "Code blocks for technical details"
          ],
          "technical_notes": "Generate markdown client-side. Use Blob for download.",
          "files_to_create": [
            "frontend/lib/export/markdown.ts"
          ],
          "depends_on": [
            "UI-024"
          ],
          "passes": false,
          "phaseId": 5
        },
        {
          "id": "UI-026",
          "title": "JSON Export",
          "description": "Implement JSON export for reports and events",
          "points": 3,
          "priority": 1,
          "acceptance_criteria": [
            "Export full report as JSON",
            "Export raw events as JSON",
            "Pretty-printed format option",
            "Includes metadata (timestamp, version)",
            "Download triggers automatically"
          ],
          "technical_notes": "Use JSON.stringify with formatting. Include schema version.",
          "files_to_create": [
            "frontend/lib/export/json.ts"
          ],
          "depends_on": [
            "UI-024"
          ],
          "passes": false,
          "phaseId": 5
        },
        {
          "id": "UI-027",
          "title": "PDF Export",
          "description": "Implement PDF export for reports (optional enhancement)",
          "points": 3,
          "priority": 2,
          "acceptance_criteria": [
            "Export button generates PDF",
            "PDF includes branding header",
            "All sections rendered correctly",
            "Charts/graphs included as images",
            "Page breaks at section boundaries"
          ],
          "technical_notes": "Use @react-pdf/renderer or browser print-to-PDF. Optional feature.",
          "files_to_create": [
            "frontend/lib/export/pdf.ts"
          ],
          "depends_on": [
            "UI-024"
          ],
          "passes": false,
          "phaseId": 5
        },
        {
          "id": "UI-028",
          "title": "Report History List",
          "description": "Build list view of historical reports",
          "points": 3,
          "priority": 2,
          "acceptance_criteria": [
            "List showing: Date, Session ID, Risk Score, Status",
            "Sort by date (newest first)",
            "Filter by risk level",
            "Click to view full report",
            "Delete report option",
            "Pagination for long lists"
          ],
          "technical_notes": "Store report metadata locally or fetch from API. Use virtual list for performance.",
          "files_to_create": [
            "frontend/app/reports/page.tsx",
            "frontend/components/reports/ReportList.tsx"
          ],
          "depends_on": [
            "UI-024"
          ],
          "passes": false,
          "phaseId": 5
        },
        {
          "id": "UI-029",
          "title": "Report Comparison View",
          "description": "Enable side-by-side comparison of two reports",
          "points": 3,
          "priority": 3,
          "acceptance_criteria": [
            "Select two reports from history",
            "Side-by-side layout",
            "Highlight differences in scores",
            "Delta indicators (improved/regressed)",
            "Category-by-category comparison"
          ],
          "technical_notes": "Two-column layout. Calculate deltas client-side.",
          "files_to_create": [
            "frontend/app/reports/compare/page.tsx",
            "frontend/components/reports/CompareView.tsx"
          ],
          "depends_on": [
            "UI-028"
          ],
          "passes": false,
          "phaseId": 5
        }
      ]
    },
    {
      "id": "E6",
      "title": "Settings & Configuration",
      "description": "User preferences and system configuration",
      "priority": 2,
      "estimated_points": 19,
      "stories": [
        {
          "id": "UI-030",
          "title": "Agent Instrumentation Config UI",
          "description": "Build settings UI for agent instrumentation options",
          "points": 3,
          "priority": 2,
          "acceptance_criteria": [
            "Default tool interception toggle",
            "Default memory monitoring toggle",
            "Default divergence threshold",
            "Auto-start evaluation toggle",
            "Settings persist across sessions"
          ],
          "technical_notes": "Store in Zustand with localStorage persistence. Apply to new sessions.",
          "files_to_create": [
            "frontend/app/settings/agent/page.tsx",
            "frontend/components/settings/AgentSettings.tsx"
          ],
          "depends_on": [
            "UI-004"
          ],
          "passes": false,
          "phaseId": 6
        },
        {
          "id": "UI-031",
          "title": "Tool Registration Form",
          "description": "Create form for registering custom tools for interception",
          "points": 3,
          "priority": 2,
          "acceptance_criteria": [
            "Add new tool: name, description, parameters schema",
            "Mark tool as dangerous (requires confirmation)",
            "List registered tools with edit/delete",
            "Import/export tool definitions as JSON",
            "Validate tool schema format"
          ],
          "technical_notes": "Store tool definitions in localStorage. Optional sync to backend.",
          "files_to_create": [
            "frontend/components/settings/ToolForm.tsx",
            "frontend/components/settings/ToolList.tsx"
          ],
          "depends_on": [
            "UI-030"
          ],
          "passes": false,
          "phaseId": 6
        },
        {
          "id": "UI-032",
          "title": "Memory Policy Configuration",
          "description": "Build UI for configuring memory access policies",
          "points": 2,
          "priority": 3,
          "acceptance_criteria": [
            "Define sensitive key patterns (regex)",
            "Set access level per pattern (read, write, delete)",
            "Alert threshold configuration",
            "Test pattern against sample keys"
          ],
          "technical_notes": "Complex regex UI. Provide presets for common patterns.",
          "files_to_create": [
            "frontend/components/settings/MemoryPolicy.tsx"
          ],
          "depends_on": [
            "UI-030"
          ],
          "passes": false,
          "phaseId": 6
        },
        {
          "id": "UI-033",
          "title": "API Key Management",
          "description": "Manage API keys for authenticated access",
          "points": 2,
          "priority": 2,
          "acceptance_criteria": [
            "Display current API key (masked)",
            "Generate new API key",
            "Copy key to clipboard",
            "Revoke key option",
            "Show key usage stats"
          ],
          "technical_notes": "API key stored securely. Show last used timestamp.",
          "files_to_create": [
            "frontend/app/settings/api-keys/page.tsx",
            "frontend/components/settings/APIKeyManager.tsx"
          ],
          "depends_on": [
            "UI-004"
          ],
          "passes": false,
          "phaseId": 6
        },
        {
          "id": "UI-034",
          "title": "Session Persistence",
          "description": "Implement session state persistence across browser sessions",
          "points": 2,
          "priority": 2,
          "acceptance_criteria": [
            "Active session survives page refresh",
            "Session recovery prompt on return",
            "Option to clear saved session",
            "Auto-expire sessions after 24 hours",
            "Multiple session support (list/switch)"
          ],
          "technical_notes": "Use localStorage for session metadata. IndexedDB for large event data.",
          "files_to_create": [
            "frontend/lib/session/persistence.ts",
            "frontend/hooks/useSessionPersistence.ts"
          ],
          "depends_on": [
            "UI-001"
          ],
          "passes": false,
          "phaseId": 6
        },
        {
          "id": "UI-035",
          "title": "Keyboard Shortcuts",
          "description": "Implement keyboard shortcuts for power users",
          "points": 2,
          "priority": 2,
          "acceptance_criteria": [
            "? key opens shortcut help modal",
            "Ctrl+E: Run Evaluation",
            "Ctrl+R: Generate Report",
            "Ctrl+D: Load Demo",
            "Ctrl+K: Open command palette",
            "Shortcuts customizable in settings"
          ],
          "technical_notes": "Use useHotkeys hook. Show shortcuts in tooltips.",
          "files_to_create": [
            "frontend/hooks/useKeyboardShortcuts.ts",
            "frontend/components/ShortcutsModal.tsx"
          ],
          "depends_on": [
            "UI-004"
          ],
          "passes": false,
          "phaseId": 6
        },
        {
          "id": "UI-036",
          "title": "Configuration Persistence Layer",
          "description": "Implement atomic file-based persistence for remote agent config and user preferences, matching Streamlit's _persist_config_to_disk() pattern",
          "points": 3,
          "priority": 1,
          "acceptance_criteria": [
            "Configurations persist to localStorage for browser sessions",
            "Optional server-side persistence via API endpoint",
            "Atomic write pattern to prevent corruption (write temp, rename)",
            "Environment variable override support (RC_REMOTE_AGENT_CONFIG_PATH)",
            "Graceful handling of corrupted config files (fallback to defaults)",
            "Config versioning for future migrations"
          ],
          "technical_notes": "Port from remote_agent_config.py persistence logic. Use localStorage for client, optional API for server sync.",
          "files_to_create": [
            "frontend/lib/persistence/config.ts",
            "frontend/lib/persistence/atomic.ts",
            "frontend/app/api/config/route.ts"
          ],
          "depends_on": [
            "UI-004"
          ],
          "passes": false,
          "phaseId": 6
        },
        {
          "id": "UI-037",
          "title": "Shared Sanitization Utilities",
          "description": "Create utility functions for HTML escaping and markdown sanitization across all components",
          "points": 2,
          "priority": 1,
          "acceptance_criteria": [
            "DOMPurify integration for HTML sanitization",
            "Markdown sanitization for user-generated content",
            "Template ID validation matching VALID_TEMPLATE_ID pattern from Streamlit",
            "URL validation utility for remote agent endpoints",
            "Input length limits matching existing constants (MAX_EVENTS_LIMIT, MAX_EXPORT_SIZE_BYTES)",
            "XSS prevention in all user-facing text displays"
          ],
          "technical_notes": "Create centralized sanitization module. Match security patterns from Streamlit components.",
          "files_to_create": [
            "frontend/lib/security/sanitize.ts",
            "frontend/lib/security/validate.ts",
            "frontend/lib/security/constants.ts"
          ],
          "depends_on": [],
          "passes": false,
          "phaseId": 6
        }
      ]
    }
  ]
}